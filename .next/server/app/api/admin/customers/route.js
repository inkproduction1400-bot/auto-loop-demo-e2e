"use strict";(()=>{var e={};e.id=436,e.ids=[436],e.modules={3524:e=>{e.exports=require("@prisma/client")},399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6293:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>g,staticGenerationAsyncStorage:()=>l});var a={};r.r(a),r.d(a,{GET:()=>p});var n=r(9303),o=r(8716),s=r(670),i=r(7070),u=r(3538);let m=(e,t)=>{let r=Number.parseInt(e??"",10);return Number.isFinite(r)&&r>0?r:t};async function p(e){try{let{searchParams:t}=new URL(e.url),r=(t.get("q")??"").trim(),a=m(t.get("page"),1),n=Math.min(100,m(t.get("size"),20)),o=(a-1)*n,s=""===r?void 0:{OR:[{name:{contains:r}},{email:{contains:r}},{phone:{contains:r}}]},p=await u._.customer.count({where:s}),c=(await u._.customer.findMany({where:s,orderBy:{createdAt:"desc"},skip:o,take:n,select:{id:!0,name:!0,email:!0,phone:!0,createdAt:!0,_count:{select:{reservations:!0}}}})).map(e=>({id:e.id,name:e.name,email:e.email,phone:e.phone,createdAt:e.createdAt.toISOString(),_count:{reservations:e._count.reservations}}));return i.NextResponse.json({meta:{page:a,size:n,total:p,totalPages:Math.max(1,Math.ceil(p/n))},items:c})}catch(e){return console.error("GET /api/admin/customers error:",e),i.NextResponse.json({error:e?.message??"internal error"},{status:500})}}let c=new n.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/admin/customers/route",pathname:"/api/admin/customers",filename:"route",bundlePath:"app/api/admin/customers/route"},resolvedPagePath:"/Users/nagai/auto-loop-demo/app/api/admin/customers/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:d,staticGenerationAsyncStorage:l,serverHooks:g}=c,h="/api/admin/customers/route";function v(){return(0,s.patchFetch)({serverHooks:g,staticGenerationAsyncStorage:l})}},3538:(e,t,r)=>{r.d(t,{_:()=>n});var a=r(3524);let n=global.prisma??new a.PrismaClient({log:["error"]})}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[276,972],()=>r(6293));module.exports=a})();