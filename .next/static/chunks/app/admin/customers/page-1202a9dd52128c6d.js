(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[781],{9682:function(e,t,r){Promise.resolve().then(r.bind(r,3128))},3128:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return m}});var s=r(7437),a=r(2265),n=r(7648),l=r(9376),i=r(3773),c=r.n(i);let u=function(e,t){var r;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(null!==(r=e.get(t))&&void 0!==r?r:s).trim()},o=(e,t,r)=>{var s;let a=Number.parseInt(null!==(s=e.get(t))&&void 0!==s?s:"",10);return Number.isFinite(a)&&a>0?a:r};function d(){let e=(0,l.useRouter)(),t=(0,l.useSearchParams)(),r=u(t,"q"),i=o(t,"page",1),d=Math.min(100,o(t,"size",20)),m=(0,a.useMemo)(()=>{let e=new URLSearchParams;return r&&e.set("q",r),e.set("page",String(i)),e.set("size",String(d)),"/api/admin/customers?".concat(e.toString())},[r,i,d]),[h,g]=(0,a.useState)(null),[_,x]=(0,a.useState)(!0),[j,f]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=!1;return(async()=>{x(!0),f(null);try{let t=await fetch(m,{cache:"no-store"});if(!t.ok)throw Error("HTTP ".concat(t.status));let r=await t.json();e||g(r)}catch(r){var t;e||f(null!==(t=null==r?void 0:r.message)&&void 0!==t?t:"fetch error")}finally{e||x(!1)}})(),()=>{e=!0}},[m]);let p=e=>{let r=new URLSearchParams(t.toString());return r.set("page",String(e)),r.set("size",String(d)),"/admin/customers?".concat(r.toString())};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h1",{className:c().title,children:"顧客一覧"}),(0,s.jsxs)("form",{className:c().toolbar,onSubmit:t=>{var r;t.preventDefault();let s=new FormData(t.currentTarget),a=new URLSearchParams,n=String(null!==(r=s.get("q"))&&void 0!==r?r:"").trim();n&&a.set("q",n),a.set("page","1"),a.set("size",String(d)),e.push("/admin/customers?".concat(a.toString()))},children:[(0,s.jsx)("input",{name:"q",placeholder:"氏名/メール/電話",defaultValue:r}),(0,s.jsx)("button",{type:"submit",children:"検索"})]}),_&&(0,s.jsx)("div",{className:c().meta,children:"読み込み中…"}),j&&(0,s.jsxs)("div",{className:c().error,children:["読み込みに失敗しました: ",j]}),h&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:c().meta,children:[h.meta.total,"件 / ",h.meta.page,"/",h.meta.totalPages,"ページ"]}),(0,s.jsx)("div",{className:c().tableWrap,children:(0,s.jsxs)("table",{className:c().table,children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"作成"}),(0,s.jsx)("th",{children:"氏名"}),(0,s.jsx)("th",{children:"メール"}),(0,s.jsx)("th",{children:"電話"}),(0,s.jsx)("th",{children:"予約数"})]})}),(0,s.jsxs)("tbody",{children:[h.items.map(e=>{var t,r,a,l;return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:new Date(e.createdAt).toLocaleString("ja-JP")}),(0,s.jsx)("td",{children:null!==(t=e.name)&&void 0!==t?t:"-"}),(0,s.jsx)("td",{children:null!==(r=e.email)&&void 0!==r?r:"-"}),(0,s.jsx)("td",{children:null!==(a=e.phone)&&void 0!==a?a:"-"}),(0,s.jsx)("td",{children:(0,s.jsx)(n.default,{href:"/admin/reservations?q=".concat(encodeURIComponent(null!==(l=e.email)&&void 0!==l?l:"")),children:e._count.reservations})})]},e.id)}),0===h.items.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:5,style:{textAlign:"center",padding:24},children:"データがありません"})})]})]})}),(0,s.jsx)("div",{className:c().pager,children:Array.from({length:h.meta.totalPages}).map((e,t)=>{let r=t+1;return(0,s.jsx)(n.default,{href:p(r),className:"".concat(c().pagebtn," ").concat(r===h.meta.page?c().active:""),children:r},r)})})]})]})}function m(){return(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{children:"読み込み中…"}),children:(0,s.jsx)(d,{})})}},7648:function(e,t,r){"use strict";r.d(t,{default:function(){return a.a}});var s=r(2972),a=r.n(s)},9376:function(e,t,r){"use strict";var s=r(5475);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},3773:function(e){e.exports={title:"customers_title__QUPQm",toolbar:"customers_toolbar__tltFK",meta:"customers_meta___deC_",error:"customers_error__WxXux",tableWrap:"customers_tableWrap__zoLgY",table:"customers_table__FP_wm",pager:"customers_pager__sslEC",pagebtn:"customers_pagebtn__L_PGF",active:"customers_active__uGMVo"}}},function(e){e.O(0,[629,972,971,117,744],function(){return e(e.s=9682)}),_N_E=e.O()}]);