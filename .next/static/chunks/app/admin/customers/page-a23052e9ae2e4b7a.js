(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[16],{5414:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var s=r(5155),a=r(2115),n=r(8173),l=r.n(n),i=r(6046),c=r(7209),o=r.n(c);let u=function(e,t){var r;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(null!==(r=e.get(t))&&void 0!==r?r:s).trim()},d=(e,t,r)=>{var s;let a=Number.parseInt(null!==(s=e.get(t))&&void 0!==s?s:"",10);return Number.isFinite(a)&&a>0?a:r};function m(){let e=(0,i.useRouter)(),t=(0,i.useSearchParams)(),r=u(t,"q"),n=d(t,"page",1),c=Math.min(100,d(t,"size",20)),m=(0,a.useMemo)(()=>{let e=new URLSearchParams;return r&&e.set("q",r),e.set("page",String(n)),e.set("size",String(c)),"/api/admin/customers?".concat(e.toString())},[r,n,c]),[h,g]=(0,a.useState)(null),[_,x]=(0,a.useState)(!0),[j,p]=(0,a.useState)(null);(0,a.useEffect)(()=>{let e=!1;return(async()=>{x(!0),p(null);try{let t=await fetch(m,{cache:"no-store"});if(!t.ok)throw Error("HTTP ".concat(t.status));let r=await t.json();e||g(r)}catch(r){var t;e||p(null!==(t=null==r?void 0:r.message)&&void 0!==t?t:"fetch error")}finally{e||x(!1)}})(),()=>{e=!0}},[m]);let v=e=>{let r=new URLSearchParams(t.toString());return r.set("page",String(e)),r.set("size",String(c)),"/admin/customers?".concat(r.toString())};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h1",{className:o().title,children:"顧客一覧"}),(0,s.jsxs)("form",{className:o().toolbar,onSubmit:t=>{var r;t.preventDefault();let s=new FormData(t.currentTarget),a=new URLSearchParams,n=String(null!==(r=s.get("q"))&&void 0!==r?r:"").trim();n&&a.set("q",n),a.set("page","1"),a.set("size",String(c)),e.push("/admin/customers?".concat(a.toString()))},children:[(0,s.jsx)("input",{name:"q",placeholder:"氏名/メール/電話",defaultValue:r}),(0,s.jsx)("button",{type:"submit",children:"検索"})]}),_&&(0,s.jsx)("div",{className:o().meta,children:"読み込み中…"}),j&&(0,s.jsxs)("div",{className:o().error,children:["読み込みに失敗しました: ",j]}),h&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:o().meta,children:[h.meta.total,"件 / ",h.meta.page,"/",h.meta.totalPages,"ページ"]}),(0,s.jsx)("div",{className:o().tableWrap,children:(0,s.jsxs)("table",{className:o().table,children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"作成"}),(0,s.jsx)("th",{children:"氏名"}),(0,s.jsx)("th",{children:"メール"}),(0,s.jsx)("th",{children:"電話"}),(0,s.jsx)("th",{children:"予約数"})]})}),(0,s.jsxs)("tbody",{children:[h.items.map(e=>{var t,r,a,n;return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:new Date(e.createdAt).toLocaleString("ja-JP")}),(0,s.jsx)("td",{children:null!==(t=e.name)&&void 0!==t?t:"-"}),(0,s.jsx)("td",{children:null!==(r=e.email)&&void 0!==r?r:"-"}),(0,s.jsx)("td",{children:null!==(a=e.phone)&&void 0!==a?a:"-"}),(0,s.jsx)("td",{children:(0,s.jsx)(l(),{href:"/admin/reservations?q=".concat(encodeURIComponent(null!==(n=e.email)&&void 0!==n?n:"")),children:e._count.reservations})})]},e.id)}),0===h.items.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:5,style:{textAlign:"center",padding:24},children:"データがありません"})})]})]})}),(0,s.jsx)("div",{className:o().pager,children:Array.from({length:h.meta.totalPages}).map((e,t)=>{let r=t+1;return(0,s.jsx)(l(),{href:v(r),className:"".concat(o().pagebtn," ").concat(r===h.meta.page?o().active:""),children:r},r)})})]})]})}function h(){return(0,s.jsx)(a.Suspense,{fallback:(0,s.jsx)("div",{children:"読み込み中…"}),children:(0,s.jsx)(m,{})})}},6046:(e,t,r)=>{"use strict";var s=r(6658);r.o(s,"useParams")&&r.d(t,{useParams:function(){return s.useParams}}),r.o(s,"useRouter")&&r.d(t,{useRouter:function(){return s.useRouter}}),r.o(s,"useSearchParams")&&r.d(t,{useSearchParams:function(){return s.useSearchParams}})},6466:(e,t,r)=>{Promise.resolve().then(r.bind(r,5414))},7209:e=>{e.exports={title:"customers_title__QUPQm",toolbar:"customers_toolbar__tltFK",meta:"customers_meta___deC_",error:"customers_error__WxXux",tableWrap:"customers_tableWrap__zoLgY",table:"customers_table__FP_wm",pager:"customers_pager__sslEC",pagebtn:"customers_pagebtn__L_PGF",active:"customers_active__uGMVo"}}},e=>{var t=t=>e(e.s=t);e.O(0,[738,441,587,358],()=>t(6466)),_N_E=e.O()}]);