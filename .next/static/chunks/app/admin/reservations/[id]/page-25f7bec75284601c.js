(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[779],{2877:function(d,a,s){Promise.resolve().then(s.bind(s,6356))},6356:function(d,a,s){"use strict";s.r(a),s.d(a,{default:function(){return i}});var e=s(7437),c=s(29),r=s.n(c),n=s(2265),l=s(9376),t=s(7648);function i(){var d,a,s;let{id:c}=(0,l.useParams)(),i=(0,l.useRouter)(),[o,x]=(0,n.useState)(null),[b,j]=(0,n.useState)(!0),[u,p]=(0,n.useState)(null),[m,f]=(0,n.useState)(""),h=(0,n.useMemo)(()=>"/api/admin/reservations/".concat(c),[c]);(0,n.useEffect)(()=>{let d=!1;return(async()=>{var a,s;j(!0),p(null);try{let s=await fetch(h,{cache:"no-store"});if(!s.ok)throw Error("HTTP ".concat(s.status));let e=await s.json();d||(x(e),f(null!==(a=e.notes)&&void 0!==a?a:""))}catch(a){d||p(null!==(s=null==a?void 0:a.message)&&void 0!==s?s:"fetch error")}finally{d||j(!1)}})(),()=>{d=!0}},[h]);let g=async d=>{confirm("ステータスを ".concat(d," に変更します。よろしいですか？"))&&(await fetch(h,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:d})}),i.refresh())},N=async()=>{await fetch(h,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({notes:m})}),i.refresh()},w=async()=>{confirm("この予約をキャンセルします。よろしいですか？")&&(await fetch(h,{method:"DELETE"}),i.refresh())};return(0,e.jsxs)("div",{className:"jsx-da822b772853cd05 wrap",children:[(0,e.jsxs)("div",{className:"jsx-da822b772853cd05 hdr",children:[(0,e.jsx)("h1",{className:"jsx-da822b772853cd05",children:"予約詳細"}),(0,e.jsx)("div",{className:"jsx-da822b772853cd05 gap"}),(0,e.jsx)(t.default,{href:"/admin/reservations",className:"btn ghost",children:"一覧に戻る"})]}),b&&(0,e.jsx)("div",{className:"jsx-da822b772853cd05 meta",children:"読み込み中…"}),u&&(0,e.jsxs)("div",{className:"jsx-da822b772853cd05 error",children:["読み込みに失敗しました: ",u]}),o&&(0,e.jsx)(e.Fragment,{children:(0,e.jsxs)("div",{className:"jsx-da822b772853cd05 grid",children:[(0,e.jsxs)("div",{className:"jsx-da822b772853cd05 card",children:[(0,e.jsx)("div",{className:"jsx-da822b772853cd05 card-ttl",children:"概要"}),(0,e.jsxs)("dl",{className:"jsx-da822b772853cd05 dl",children:[(0,e.jsx)("dt",{className:"jsx-da822b772853cd05",children:"ID"}),(0,e.jsx)("dd",{className:"jsx-da822b772853cd05",children:o.id}),(0,e.jsx)("dt",{className:"jsx-da822b772853cd05",children:"作成"}),(0,e.jsx)("dd",{className:"jsx-da822b772853cd05",children:new Date(o.createdAt).toLocaleString("ja-JP")}),(0,e.jsx)("dt",{className:"jsx-da822b772853cd05",children:"更新"}),(0,e.jsx)("dd",{className:"jsx-da822b772853cd05",children:new Date(o.updatedAt).toLocaleString("ja-JP")}),(0,e.jsx)("dt",{className:"jsx-da822b772853cd05",children:"日付"}),(0,e.jsx)("dd",{className:"jsx-da822b772853cd05",children:new Date(o.date).toLocaleDateString("ja-JP")}),(0,e.jsx)("dt",{className:"jsx-da822b772853cd05",children:"枠"}),(0,e.jsx)("dd",{className:"jsx-da822b772853cd05",children:o.slot}),(0,e.jsx)("dt",{className:"jsx-da822b772853cd05",children:"人数"}),(0,e.jsx)("dd",{className:"jsx-da822b772853cd05",children:(()=>{var d,a,s,e,c,r,n,l,t;let i=null!==(d=o.counts)&&void 0!==d?d:{},x=(null!==(a=i.adult)&&void 0!==a?a:0)+(null!==(s=i.student)&&void 0!==s?s:0)+(null!==(e=i.child)&&void 0!==e?e:0)+(null!==(c=i.infant)&&void 0!==c?c:0);return"".concat(x," 名（大人").concat(null!==(r=i.adult)&&void 0!==r?r:0," / 学生").concat(null!==(n=i.student)&&void 0!==n?n:0," / 小人").concat(null!==(l=i.child)&&void 0!==l?l:0," / 幼児").concat(null!==(t=i.infant)&&void 0!==t?t:0,"）")})()}),(0,e.jsx)("dt",{className:"jsx-da822b772853cd05",children:"金額"}),(0,e.jsxs)("dd",{className:"jsx-da822b772853cd05",children:["\xa5",o.amount.toLocaleString("ja-JP")]}),(0,e.jsx)("dt",{className:"jsx-da822b772853cd05",children:"状態"}),(0,e.jsx)("dd",{className:"jsx-da822b772853cd05",children:(0,e.jsx)("span",{className:"jsx-da822b772853cd05 "+"chip ".concat(o.status.toLowerCase()),children:o.status})})]}),(0,e.jsxs)("div",{className:"jsx-da822b772853cd05 actions",children:[(0,e.jsx)("button",{onClick:()=>g("PAID"),className:"jsx-da822b772853cd05 btn",children:"支払い済みにする"}),(0,e.jsx)("button",{onClick:()=>g("PENDING"),className:"jsx-da822b772853cd05 btn",children:"保留に戻す"}),(0,e.jsx)("button",{onClick:w,className:"jsx-da822b772853cd05 btn danger",children:"キャンセル"})]})]}),(0,e.jsxs)("div",{className:"jsx-da822b772853cd05 card",children:[(0,e.jsx)("div",{className:"jsx-da822b772853cd05 card-ttl",children:"顧客"}),o.customer?(0,e.jsxs)("dl",{className:"jsx-da822b772853cd05 dl",children:[(0,e.jsx)("dt",{className:"jsx-da822b772853cd05",children:"氏名"}),(0,e.jsx)("dd",{className:"jsx-da822b772853cd05",children:null!==(d=o.customer.name)&&void 0!==d?d:"-"}),(0,e.jsx)("dt",{className:"jsx-da822b772853cd05",children:"メール"}),(0,e.jsx)("dd",{className:"jsx-da822b772853cd05",children:null!==(a=o.customer.email)&&void 0!==a?a:"-"}),(0,e.jsx)("dt",{className:"jsx-da822b772853cd05",children:"電話"}),(0,e.jsx)("dd",{className:"jsx-da822b772853cd05",children:null!==(s=o.customer.phone)&&void 0!==s?s:"-"})]}):(0,e.jsx)("div",{className:"jsx-da822b772853cd05 muted",children:"顧客情報なし"}),(0,e.jsx)("div",{className:"jsx-da822b772853cd05 card-ttl mt",children:"メモ"}),(0,e.jsx)("textarea",{rows:6,value:m,onChange:d=>f(d.target.value),placeholder:"社内用メモを記入…",className:"jsx-da822b772853cd05 input"}),(0,e.jsx)("div",{className:"jsx-da822b772853cd05 actions",children:(0,e.jsx)("button",{onClick:N,className:"jsx-da822b772853cd05 btn primary",children:"メモを保存"})})]})]})}),(0,e.jsx)(r(),{id:"da822b772853cd05",children:".wrap.jsx-da822b772853cd05{display:grid;gap:12px}.hdr.jsx-da822b772853cd05{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-webkit-align-items:center;-moz-box-align:center;-ms-flex-align:center;align-items:center;gap:8px}.hdr.jsx-da822b772853cd05 h1.jsx-da822b772853cd05{margin:0;font-weight:900}.gap.jsx-da822b772853cd05{-webkit-box-flex:1;-webkit-flex:1;-moz-box-flex:1;-ms-flex:1;flex:1}.meta.jsx-da822b772853cd05{color:#64748b;font-size:13px}.error.jsx-da822b772853cd05{color:#b91c1c;background:#fee2e2;border:1px solid#fecaca;padding:8px 10px;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px}.grid.jsx-da822b772853cd05{display:grid;grid-template-columns:1fr 1fr;gap:16px}@media(max-width:960px){.grid.jsx-da822b772853cd05{grid-template-columns:1fr}}.card.jsx-da822b772853cd05{background:#fff;border:1px solid#e5e7eb;-webkit-border-radius:12px;-moz-border-radius:12px;border-radius:12px;padding:16px}.card-ttl.jsx-da822b772853cd05{font-weight:800;margin-bottom:8px}.dl.jsx-da822b772853cd05{display:grid;grid-template-columns:120px 1fr;gap:8px 12px;-webkit-box-align:start;-webkit-align-items:start;-moz-box-align:start;-ms-flex-align:start;align-items:start}.dl.jsx-da822b772853cd05 dt.jsx-da822b772853cd05{color:#64748b;font-size:12px}.dl.jsx-da822b772853cd05 dd.jsx-da822b772853cd05{margin:0}.actions.jsx-da822b772853cd05{display:-webkit-box;display:-webkit-flex;display:-moz-box;display:-ms-flexbox;display:flex;gap:8px;margin-top:12px;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap}.btn.jsx-da822b772853cd05{-webkit-appearance:none;-moz-appearance:none;-ms-appearance:none;appearance:none;border:1px solid#cbd5e1;background:#fff;color:#0f172a;padding:8px 12px;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;cursor:pointer}.btn.jsx-da822b772853cd05:hover{background:#f8fafc}.btn.primary.jsx-da822b772853cd05{background:#2563eb;color:#fff;border-color:#2563eb}.btn.ghost.jsx-da822b772853cd05{background:#fff}.btn.danger.jsx-da822b772853cd05{color:#b91c1c;border-color:#fecaca;background:#fff5f5}.chip.jsx-da822b772853cd05{padding:3px 8px;-webkit-border-radius:999px;-moz-border-radius:999px;border-radius:999px;font-size:12px;border:1px solid#cbd5e1}.chip.paid.jsx-da822b772853cd05{background:#ecfdf5;border-color:#bbf7d0;color:#0f766e}.chip.pending.jsx-da822b772853cd05{background:#fff7ed;border-color:#fed7aa;color:#c2410c}.chip.cancelled.jsx-da822b772853cd05{background:#fee2e2;border-color:#fecaca;color:#b91c1c}.muted.jsx-da822b772853cd05{color:#64748b;font-size:12px}.mt.jsx-da822b772853cd05{margin-top:12px}.input.jsx-da822b772853cd05{width:100%;border:1px solid#cbd5e1;-webkit-border-radius:10px;-moz-border-radius:10px;border-radius:10px;padding:10px 12px;font-size:14px;background:#fff}"})]})}},7648:function(d,a,s){"use strict";s.d(a,{default:function(){return c.a}});var e=s(2972),c=s.n(e)},9376:function(d,a,s){"use strict";var e=s(5475);s.o(e,"useParams")&&s.d(a,{useParams:function(){return e.useParams}}),s.o(e,"useRouter")&&s.d(a,{useRouter:function(){return e.useRouter}}),s.o(e,"useSearchParams")&&s.d(a,{useSearchParams:function(){return e.useSearchParams}})}},function(d){d.O(0,[972,29,971,117,744],function(){return d(d.s=2877)}),_N_E=d.O()}]);