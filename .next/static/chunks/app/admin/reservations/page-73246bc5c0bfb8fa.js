(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[72],{3802:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>h});var s=a(5155),r=a(2115),n=a(8173),l=a.n(n),i=a(6046),c=a(6825),d=a.n(c);function o(e,t){var a;let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(null!==(a=e.get(t))&&void 0!==a?a:s).trim()}function u(e,t,a){var s;let r=Number.parseInt(null!==(s=e.get(t))&&void 0!==s?s:"",10);return Number.isFinite(r)&&r>0?r:a}function h(){return(0,s.jsx)(r.Suspense,{fallback:(0,s.jsx)("div",{className:d().meta,children:"読み込み中…"}),children:(0,s.jsx)(m,{})})}function m(){let e=(0,i.useRouter)(),t=(0,i.useSearchParams)(),a=o(t,"q"),n=o(t,"status"),c=o(t,"dateFrom"),h=o(t,"dateTo"),m=u(t,"page",1),p=Math.min(100,u(t,"size",20)),[g,_]=(0,r.useState)(null),[j,x]=(0,r.useState)(!0),[v,S]=(0,r.useState)(null),f=(0,r.useMemo)(()=>{let e=new URLSearchParams;return a&&e.set("q",a),n&&e.set("status",n),c&&e.set("dateFrom",c),h&&e.set("dateTo",h),e.set("page",String(m)),e.set("size",String(p)),"/api/admin/reservations?".concat(e.toString())},[a,n,c,h,m,p]);(0,r.useEffect)(()=>{let e=!1;return(async()=>{x(!0),S(null);try{let t=await fetch(f,{cache:"no-store"});if(!t.ok)throw Error("HTTP ".concat(t.status));let a=await t.json();e||_(a)}catch(a){var t;e||S(null!==(t=null==a?void 0:a.message)&&void 0!==t?t:"fetch error")}finally{e||x(!1)}})(),()=>{e=!0}},[f]);let N=e=>{let a=new URLSearchParams(t.toString());return a.set("page",String(e)),a.set("size",String(p)),"/admin/reservations?".concat(a.toString())};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("h1",{className:d().title,children:"予約一覧"}),(0,s.jsxs)("form",{className:d().toolbar,onSubmit:t=>{var a,s,r,n;t.preventDefault();let l=new FormData(t.currentTarget),i=new URLSearchParams,c=String(null!==(a=l.get("q"))&&void 0!==a?a:"").trim(),d=String(null!==(s=l.get("status"))&&void 0!==s?s:"").trim(),o=String(null!==(r=l.get("dateFrom"))&&void 0!==r?r:"").trim(),u=String(null!==(n=l.get("dateTo"))&&void 0!==n?n:"").trim();c&&i.set("q",c),d&&i.set("status",d),o&&i.set("dateFrom",o),u&&i.set("dateTo",u),i.set("page","1"),i.set("size",String(p)),e.push("/admin/reservations?".concat(i.toString()))},children:[(0,s.jsx)("input",{name:"q",placeholder:"キーワード",defaultValue:a}),(0,s.jsx)("input",{name:"dateFrom",type:"date",defaultValue:c}),(0,s.jsx)("input",{name:"dateTo",type:"date",defaultValue:h}),(0,s.jsxs)("select",{name:"status",defaultValue:n,children:[(0,s.jsx)("option",{value:"",children:"すべての状態"}),(0,s.jsx)("option",{value:"PENDING",children:"PENDING"}),(0,s.jsx)("option",{value:"PAID",children:"PAID"}),(0,s.jsx)("option",{value:"CANCELLED",children:"CANCELLED"})]}),(0,s.jsx)("button",{type:"submit",children:"検索"})]}),j&&(0,s.jsx)("div",{className:d().meta,children:"読み込み中…"}),v&&(0,s.jsxs)("div",{className:d().error,children:["読み込みに失敗しました: ",v]}),g&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{className:d().meta,children:[g.meta.total,"件 / ",g.meta.page,"/",g.meta.totalPages,"ページ"]}),(0,s.jsx)("div",{className:d().tableWrap,children:(0,s.jsxs)("table",{className:d().table,children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"作成"}),(0,s.jsx)("th",{children:"日付"}),(0,s.jsx)("th",{children:"枠"}),(0,s.jsx)("th",{children:"人数"}),(0,s.jsx)("th",{children:"金額"}),(0,s.jsx)("th",{children:"顧客"}),(0,s.jsx)("th",{children:"状態"}),(0,s.jsx)("th",{children:"詳細"})]})}),(0,s.jsxs)("tbody",{children:[g.items.map(e=>{var t,a,r,n,i;let c=null!==(t=e.counts)&&void 0!==t?t:{},o=(null!==(a=c.adult)&&void 0!==a?a:0)+(null!==(r=c.student)&&void 0!==r?r:0)+(null!==(n=c.child)&&void 0!==n?n:0)+(null!==(i=c.infant)&&void 0!==i?i:0);return(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:new Date(e.createdAt).toLocaleString("ja-JP")}),(0,s.jsx)("td",{children:new Date(e.date).toLocaleDateString("ja-JP")}),(0,s.jsx)("td",{children:e.slot}),(0,s.jsx)("td",{children:o}),(0,s.jsxs)("td",{children:["\xa5",e.amount.toLocaleString("ja-JP")]}),(0,s.jsx)("td",{children:e.customer?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{children:e.customer.name}),(0,s.jsx)("div",{className:d().muted,children:e.customer.email})]}):(0,s.jsx)("span",{className:d().muted,children:"-"})}),(0,s.jsx)("td",{children:(0,s.jsx)("span",{className:"".concat(d().chip," ").concat(d()["chip_".concat(e.status.toLowerCase())]),children:e.status})}),(0,s.jsx)("td",{children:(0,s.jsx)(l(),{href:"/admin/reservations/".concat(e.id),children:"詳細"})})]},e.id)}),0===g.items.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:8,style:{textAlign:"center",padding:24},children:"該当データがありません"})})]})]})}),(0,s.jsx)("div",{className:d().pager,children:Array.from({length:g.meta.totalPages}).map((e,t)=>{let a=t+1;return(0,s.jsx)(l(),{href:N(a),className:"".concat(d().pagebtn," ").concat(a===g.meta.page?d().active:""),children:a},a)})})]})]})}},5266:(e,t,a)=>{Promise.resolve().then(a.bind(a,3802))},6046:(e,t,a)=>{"use strict";var s=a(6658);a.o(s,"useParams")&&a.d(t,{useParams:function(){return s.useParams}}),a.o(s,"useRouter")&&a.d(t,{useRouter:function(){return s.useRouter}}),a.o(s,"useSearchParams")&&a.d(t,{useSearchParams:function(){return s.useSearchParams}})},6825:e=>{e.exports={title:"page_title__I9XI_",toolbar:"page_toolbar__MVZUe",meta:"page_meta__clYRu",error:"page_error__OTsdL",tableWrap:"page_tableWrap__EqxdP",table:"page_table__fo9_Z",muted:"page_muted__OWUi0",chip:"page_chip__sKzwu",chip_paid:"page_chip_paid__jVo4J",chip_pending:"page_chip_pending__VUnyL",chip_cancelled:"page_chip_cancelled__OW8TY",pager:"page_pager__JYAaQ",pagebtn:"page_pagebtn__kz4AP",active:"page_active__qvc2W"}}},e=>{var t=t=>e(e.s=t);e.O(0,[154,441,587,358],()=>t(5266)),_N_E=e.O()}]);