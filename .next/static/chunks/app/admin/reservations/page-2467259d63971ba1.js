(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[729],{2913:function(e,t,a){Promise.resolve().then(a.bind(a,3072))},3072:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return o}});var n=a(7437),r=a(2265),s=a(7648),i=a(9376),l=a(7453),c=a.n(l);function d(e,t){var a;let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";return(null!==(a=e.get(t))&&void 0!==a?a:n).trim()}function u(e,t,a){var n;let r=Number.parseInt(null!==(n=e.get(t))&&void 0!==n?n:"",10);return Number.isFinite(r)&&r>0?r:a}function o(){return(0,n.jsx)(r.Suspense,{fallback:(0,n.jsx)("div",{className:c().meta,children:"読み込み中…"}),children:(0,n.jsx)(h,{})})}function h(){let e=(0,i.useRouter)(),t=(0,i.useSearchParams)(),a=d(t,"q"),l=d(t,"status"),o=d(t,"dateFrom"),h=d(t,"dateTo"),m=u(t,"page",1),p=Math.min(100,u(t,"size",20)),[g,_]=(0,r.useState)(null),[j,x]=(0,r.useState)(!0),[v,f]=(0,r.useState)(null),S=(0,r.useMemo)(()=>{let e=new URLSearchParams;return a&&e.set("q",a),l&&e.set("status",l),o&&e.set("dateFrom",o),h&&e.set("dateTo",h),e.set("page",String(m)),e.set("size",String(p)),"/api/admin/reservations?".concat(e.toString())},[a,l,o,h,m,p]);(0,r.useEffect)(()=>{let e=!1;return(async()=>{x(!0),f(null);try{let t=await fetch(S,{cache:"no-store"});if(!t.ok)throw Error("HTTP ".concat(t.status));let a=await t.json();e||_(a)}catch(a){var t;e||f(null!==(t=null==a?void 0:a.message)&&void 0!==t?t:"fetch error")}finally{e||x(!1)}})(),()=>{e=!0}},[S]);let N=e=>{let a=new URLSearchParams(t.toString());return a.set("page",String(e)),a.set("size",String(p)),"/admin/reservations?".concat(a.toString())};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h1",{className:c().title,children:"予約一覧"}),(0,n.jsxs)("form",{className:c().toolbar,onSubmit:t=>{var a,n,r,s;t.preventDefault();let i=new FormData(t.currentTarget),l=new URLSearchParams,c=String(null!==(a=i.get("q"))&&void 0!==a?a:"").trim(),d=String(null!==(n=i.get("status"))&&void 0!==n?n:"").trim(),u=String(null!==(r=i.get("dateFrom"))&&void 0!==r?r:"").trim(),o=String(null!==(s=i.get("dateTo"))&&void 0!==s?s:"").trim();c&&l.set("q",c),d&&l.set("status",d),u&&l.set("dateFrom",u),o&&l.set("dateTo",o),l.set("page","1"),l.set("size",String(p)),e.push("/admin/reservations?".concat(l.toString()))},children:[(0,n.jsx)("input",{name:"q",placeholder:"キーワード",defaultValue:a}),(0,n.jsx)("input",{name:"dateFrom",type:"date",defaultValue:o}),(0,n.jsx)("input",{name:"dateTo",type:"date",defaultValue:h}),(0,n.jsxs)("select",{name:"status",defaultValue:l,children:[(0,n.jsx)("option",{value:"",children:"すべての状態"}),(0,n.jsx)("option",{value:"PENDING",children:"PENDING"}),(0,n.jsx)("option",{value:"PAID",children:"PAID"}),(0,n.jsx)("option",{value:"CANCELLED",children:"CANCELLED"})]}),(0,n.jsx)("button",{type:"submit",children:"検索"})]}),j&&(0,n.jsx)("div",{className:c().meta,children:"読み込み中…"}),v&&(0,n.jsxs)("div",{className:c().error,children:["読み込みに失敗しました: ",v]}),g&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("div",{className:c().meta,children:[g.meta.total,"件 / ",g.meta.page,"/",g.meta.totalPages,"ページ"]}),(0,n.jsx)("div",{className:c().tableWrap,children:(0,n.jsxs)("table",{className:c().table,children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{children:"作成"}),(0,n.jsx)("th",{children:"日付"}),(0,n.jsx)("th",{children:"枠"}),(0,n.jsx)("th",{children:"人数"}),(0,n.jsx)("th",{children:"金額"}),(0,n.jsx)("th",{children:"顧客"}),(0,n.jsx)("th",{children:"状態"}),(0,n.jsx)("th",{children:"詳細"})]})}),(0,n.jsxs)("tbody",{children:[g.items.map(e=>{var t,a,r,i,l;let d=null!==(t=e.counts)&&void 0!==t?t:{},u=(null!==(a=d.adult)&&void 0!==a?a:0)+(null!==(r=d.student)&&void 0!==r?r:0)+(null!==(i=d.child)&&void 0!==i?i:0)+(null!==(l=d.infant)&&void 0!==l?l:0);return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:new Date(e.createdAt).toLocaleString("ja-JP")}),(0,n.jsx)("td",{children:new Date(e.date).toLocaleDateString("ja-JP")}),(0,n.jsx)("td",{children:e.slot}),(0,n.jsx)("td",{children:u}),(0,n.jsxs)("td",{children:["\xa5",e.amount.toLocaleString("ja-JP")]}),(0,n.jsx)("td",{children:e.customer?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{children:e.customer.name}),(0,n.jsx)("div",{className:c().muted,children:e.customer.email})]}):(0,n.jsx)("span",{className:c().muted,children:"-"})}),(0,n.jsx)("td",{children:(0,n.jsx)("span",{className:"".concat(c().chip," ").concat(c()["chip_".concat(e.status.toLowerCase())]),children:e.status})}),(0,n.jsx)("td",{children:(0,n.jsx)(s.default,{href:"/admin/reservations/".concat(e.id),children:"詳細"})})]},e.id)}),0===g.items.length&&(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:8,style:{textAlign:"center",padding:24},children:"該当データがありません"})})]})]})}),(0,n.jsx)("div",{className:c().pager,children:Array.from({length:g.meta.totalPages}).map((e,t)=>{let a=t+1;return(0,n.jsx)(s.default,{href:N(a),className:"".concat(c().pagebtn," ").concat(a===g.meta.page?c().active:""),children:a},a)})})]})]})}},7648:function(e,t,a){"use strict";a.d(t,{default:function(){return r.a}});var n=a(2972),r=a.n(n)},9376:function(e,t,a){"use strict";var n=a(5475);a.o(n,"useParams")&&a.d(t,{useParams:function(){return n.useParams}}),a.o(n,"useRouter")&&a.d(t,{useRouter:function(){return n.useRouter}}),a.o(n,"useSearchParams")&&a.d(t,{useSearchParams:function(){return n.useSearchParams}})},7453:function(e){e.exports={title:"page_title__I9XI_",toolbar:"page_toolbar__MVZUe",meta:"page_meta__clYRu",error:"page_error__OTsdL",tableWrap:"page_tableWrap__EqxdP",table:"page_table__fo9_Z",muted:"page_muted__OWUi0",chip:"page_chip__sKzwu",chip_paid:"page_chip_paid__jVo4J",chip_pending:"page_chip_pending__VUnyL",chip_cancelled:"page_chip_cancelled__OW8TY",pager:"page_pager__JYAaQ",pagebtn:"page_pagebtn__kz4AP",active:"page_active__qvc2W"}}},function(e){e.O(0,[611,972,971,117,744],function(){return e(e.s=2913)}),_N_E=e.O()}]);